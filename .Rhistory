options(dplyr.summarise.inform = FALSE)
options("max.print"=5000)
########################
## Some necessary packages (This only installs packages not yet installed)
########################
## Package names
packages <- c("spdep", "spData", "rgdal","fastDummies","reshape2","spatialreg","INLA","dplyr","sp","RColorBrewer","geodata","ggplot2","readxl","tidyverse")
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
## Packages loading
invisible(lapply(packages, library, character.only = TRUE))
remotes::install_version("INLA", version="22.05.03",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/testing"), dep=TRUE)
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
## Packages loading
invisible(lapply(packages, library, character.only = TRUE))
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
library(INLA)
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
options(dplyr.summarise.inform = FALSE)
options("max.print"=5000)
library(INLA)
########################
## Some necessary packages (This only installs packages not yet installed)
########################
## Package names
packages <- c("spdep", "spData", "rgdal","fastDummies","reshape2","spatialreg","INLA","dplyr","sp","RColorBrewer","geodata","ggplot2","readxl","tidyverse")
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)## Packages loading
install.packages("INLA", repos = c(getOption("repos"), INLA = "https://inla.r-inla-download.org/R/stable"), dep = TRUE)
invisible(lapply(packages, library, character.only = TRUE))
# read data dengue
data <- read_excel("C:/Users/skybl/OneDrive/Documents/Dengue_spatiotemporal/data_dengue/2011-4f.xlsx")
options(dplyr.summarise.inform = FALSE)
options("max.print"=5000)
library(INLA)
########################
## Some necessary packages (This only installs packages not yet installed)
########################
## Package names
packages <- c("spdep", "spData", "rgdal","fastDummies","reshape2","spatialreg","INLA","dplyr","sp","RColorBrewer","geodata","ggplot2","readxl","tidyverse")
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)## Packages loading
install.packages("INLA", repos = c(getOption("repos"), INLA = "https://inla.r-inla-download.org/R/stable"), dep = TRUE)
library(INLA)
library(INLA)
########################
## Some necessary packages (This only installs packages not yet installed)
########################
## Package names
packages <- c("spdep", "spData", "rgdal","fastDummies","reshape2","spatialreg","dplyr","sp","RColorBrewer","geodata","ggplot2","readxl","tidyverse")
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)## Packages loading
install.packages("INLA", repos = c(getOption("repos"), INLA = "https://inla.r-inla-download.org/R/stable"), dep = TRUE)
########################
## Some necessary packages (This only installs packages not yet installed)
########################
## Package names
packages <- c("spdep", "spData", "rgdal","fastDummies","reshape2","spatialreg","dplyr","sp","RColorBrewer","geodata","ggplot2","readxl","tidyverse")
## Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)## Packages loading
#install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)## Packages loading
invisible(lapply(packages, library, character.only = TRUE))
# read data dengue
data <- read_excel("C:/Users/Public/senior/DataDengue_2011_5factor.csv")
# read data dengue
data <- read_csv("C:/Users/Public/senior/DataDengue_2011_5factor.csv")
J <- length(unique(data$type))
S <- length(unique(data$area))
T <- length(unique(data$time))
datafilter <- data[(nrow(data) - J*S)+1 :nrow(data),]
datafilter <- na.omit(datafilter)
datafilter$OBS <- NA
datafilter$time <- datafilter$time +1
data_combine <- rbind(data, datafilter)
#load initial M-model
source("./Mmodel_icar.R")  ## Intrinsic multivariate CAR latent effect
source("./INLA_Mmodel_lcar.R")
#load initial M-model
source("C:/Users/Public/senior/modelMmodel_icar.R")  ## Intrinsic multivariate CAR latent effect
#load initial M-model
source("C:/Users/Public/senior/model/Mmodel_icar.R")  ## Intrinsic multivariate CAR latent effect
## through the use of M-models Pipeline
#source("C:/Users/skybl/OneDrive/Documents/Dengue_spatiotemporal/R/MCAR_INLA_ST.R")
source("C:/Users/skybl/OneDrive/Documents/Dengue_spatiotemporal/R/MCAR_INLA_ST_Prediction.R")
#Load geospatial Thailand map data
thai_map <- readOGR("C:/Users/skybl/OneDrive/Documents/Dengue_spatiotemporal/shp_thai/gadm41_THA_1.shp")
colnames(thai_map@data)[4] <- "area" #change column name in Thailand map data
proj4string(thai_map) <- CRS("+proj=longlat +ellps=clrk66")
#Load geospatial Thailand map data
thai_map <- readOGR("C:/Users/Public/senior/TH_Province.shp")
colnames(thai_map@data)[4] <- "area" #change column name in Thailand map data
#Load geospatial Thailand map data
thai_map <- readOGR("C:/Users/Public/senior/TH_Province.shp")
colnames(thai_map@data)[4] <- "area" #change column name in Thailand map data
#Load geospatial Thailand map data
thai_map <- readOGR("C:/Users/Public/senior/TH_Province.shp")
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/TH_Province.shp")
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm3.shp")
colnames(thai_map@data)[4] <- "area" #change column name in Thailand map data
proj4string(thai_map) <- CRS("+proj=longlat +ellps=clrk66")
colnames(thai_map@data)[4] <- "area" #change column name in Thailand map data
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm3.shp")
View(thai_map)
colnames(thai_map)[3] <- "area" #change column name in Thailand map data
proj4string(thai_map) <- CRS("+proj=longlat +ellps=clrk66")
View(thai_map)
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm3.shp")
View(thai_map)
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm0.shp")
View(thai_map)
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm1.shp")
View(thai_map)
colnames(thai_map)[5] <- "area" #change column name in Thailand map data
View(thai_map)
MODELS.inla.icar.prediction.3 <- MCAR_INLA_ST_Prediction(carto=thai_map, data=data_combine,  ID.area="area", ID.year="time", ID.disease="type",
O="OBS", E="EXP", spatial="intrinsic", temporal="rw1", interaction="none",
strategy="simplified.laplace")
MODELS.inla.icar <- MCAR_INLA_ST(carto=thai_map, data=data_combine,  ID.area="area", ID.year="time", ID.disease="type",
O="OBS", E="EXP", spatial="intrinsic", temporal="rw1", interaction="none",
strategy="simplified.laplace")
## through the use of M-models Pipeline
#source("C:/Users/skybl/OneDrive/Documents/Dengue_spatiotemporal/R/MCAR_INLA_ST.R")
source("C:/Users/Public/senior/model/MCAR_INLA_ST_Prediction.R")
## through the use of M-models Pipeline
source("C:/Users/Public/senior/model/MCAR_INLA_ST.R")
source("C:/Users/Public/senior/model/MCAR_INLA_ST_Prediction.R")
#Load geospatial Thailand map data
thai_map <- read_sf("C:/Users/Public/senior/THA_adm/THA_adm1.shp")
colnames(thai_map)[5] <- "area" #change column name in Thailand map data
MODELS.inla.icar <- MCAR_INLA_ST(carto=thai_map, data=data_combine,  ID.area="area", ID.year="time", ID.disease="type",
O="OBS", E="EXP", spatial="intrinsic", temporal="rw1", interaction="none",
strategy="simplified.laplace")
library(INLA)
MODELS.inla.icar <- MCAR_INLA_ST(carto=thai_map, data=data_combine,  ID.area="area", ID.year="time", ID.disease="type",
O="OBS", E="EXP", spatial="intrinsic", temporal="rw1", interaction="none",
strategy="simplified.laplace")
View(MODELS.inla.icar)
View(MODELS.inla.icar)
View(MODELS.inla.icar)
